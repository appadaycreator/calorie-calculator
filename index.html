<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ ã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—æ©Ÿ - ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ç‰ˆ</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TXQGZRF9');</script>
    <style>
        * {
            font-family: 'Noto Sans JP', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        
        .input-field {
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .btn-gradient {
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            transition: all 0.3s ease;
        }
        
        .btn-gradient:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
        }
        
        .result-card {
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            transition: all 0.3s ease;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            stroke-dasharray: 251.2;
            stroke-dashoffset: 251.2;
            transition: stroke-dashoffset 1s ease-in-out;
        }
        
        .floating-icon {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body class="gradient-bg">
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXQGZRF9"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <div class="container mx-auto px-4 py-8">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="text-center mb-12 animate-fade-in">
            <div class="floating-icon inline-block text-6xl mb-4">ğŸ</div>
            <h1 class="text-5xl font-bold text-white mb-4">ã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—æ©Ÿ</h1>
            <p class="text-xl text-gray-200">ç›®æ¨™ä½“é‡ã¾ã§ã‚ã¨ä½•kcalï¼Ÿç†æƒ³ã®ä½“å‹ã‚’æ‰‹ã«å…¥ã‚Œã‚ˆã†ï¼</p>
        </div>

        <!-- ãƒ¡ã‚¤ãƒ³è¨ˆç®—ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="max-w-4xl mx-auto mb-12">
            <div class="glass-card rounded-3xl p-8 animate-fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <!-- èº«é•· -->
                    <div class="space-y-2">
                        <label class="block text-white font-semibold text-lg">
                            <i class="fas fa-ruler-vertical mr-2 text-yellow-300"></i>èº«é•· (cm)
                        </label>
                        <input type="number" id="height" class="input-field w-full px-4 py-3 rounded-xl border-0 focus:outline-none focus:ring-2 focus:ring-purple-400 text-lg" placeholder="170">
                    </div>

                    <!-- ä½“é‡ -->
                    <div class="space-y-2">
                        <label class="block text-white font-semibold text-lg">
                            <i class="fas fa-weight mr-2 text-blue-300"></i>ç¾åœ¨ã®ä½“é‡ (kg)
                        </label>
                        <input type="number" id="weight" class="input-field w-full px-4 py-3 rounded-xl border-0 focus:outline-none focus:ring-2 focus:ring-purple-400 text-lg" placeholder="70">
                    </div>

                    <!-- å¹´é½¢ -->
                    <div class="space-y-2">
                        <label class="block text-white font-semibold text-lg">
                            <i class="fas fa-birthday-cake mr-2 text-pink-300"></i>å¹´é½¢
                        </label>
                        <input type="number" id="age" class="input-field w-full px-4 py-3 rounded-xl border-0 focus:outline-none focus:ring-2 focus:ring-purple-400 text-lg" placeholder="30">
                    </div>

                    <!-- æ€§åˆ¥ -->
                    <div class="space-y-2">
                        <label class="block text-white font-semibold text-lg">
                            <i class="fas fa-venus-mars mr-2 text-green-300"></i>æ€§åˆ¥
                        </label>
                        <select id="gender" class="input-field w-full px-4 py-3 rounded-xl border-0 focus:outline-none focus:ring-2 focus:ring-purple-400 text-lg">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="male">ç”·æ€§</option>
                            <option value="female">å¥³æ€§</option>
                        </select>
                    </div>

                    <!-- æ´»å‹•ãƒ¬ãƒ™ãƒ« -->
                    <div class="space-y-2">
                        <label class="block text-white font-semibold text-lg">
                            <i class="fas fa-running mr-2 text-orange-300"></i>æ´»å‹•ãƒ¬ãƒ™ãƒ«
                        </label>
                        <select id="activity" class="input-field w-full px-4 py-3 rounded-xl border-0 focus:outline-none focus:ring-2 focus:ring-purple-400 text-lg">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="1.2">åº§ã‚ŠãŒã¡ï¼ˆã»ã¨ã‚“ã©é‹å‹•ã—ãªã„ï¼‰</option>
                            <option value="1.375">è»½ã„é‹å‹•ï¼ˆé€±1-3å›ï¼‰</option>
                            <option value="1.55">æ™®é€šã®é‹å‹•ï¼ˆé€±3-5å›ï¼‰</option>
                            <option value="1.725">æ¿€ã—ã„é‹å‹•ï¼ˆé€±6-7å›ï¼‰</option>
                            <option value="1.9">éå¸¸ã«æ¿€ã—ã„é‹å‹•ï¼ˆ1æ—¥2å›ãªã©ï¼‰</option>
                        </select>
                    </div>

                    <!-- ç›®æ¨™ä½“é‡ -->
                    <div class="space-y-2">
                        <label class="block text-white font-semibold text-lg">
                            <i class="fas fa-bullseye mr-2 text-red-300"></i>ç›®æ¨™ä½“é‡ (kg)
                        </label>
                        <input type="number" id="targetWeight" class="input-field w-full px-4 py-3 rounded-xl border-0 focus:outline-none focus:ring-2 focus:ring-purple-400 text-lg" placeholder="65">
                    </div>
                </div>

                <div class="text-center">
                    <button onclick="calculateCalories()" class="btn-gradient text-white px-12 py-4 rounded-full font-bold text-xl shadow-lg">
                        <i class="fas fa-calculator mr-2"></i>è¨ˆç®—ã™ã‚‹
                    </button>
                </div>
            </div>
        </div>

        <!-- çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div id="results" class="max-w-6xl mx-auto mb-12 hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <!-- BMR -->
                <div class="result-card rounded-2xl p-6 text-center">
                    <div class="text-4xl mb-3">âš¡</div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">åŸºç¤ä»£è¬ç‡ (BMR)</h3>
                    <div id="bmrResult" class="text-3xl font-bold text-purple-600">-</div>
                    <p class="text-gray-500 mt-2">kcal/æ—¥</p>
                </div>

                <!-- TDEE -->
                <div class="result-card rounded-2xl p-6 text-center">
                    <div class="text-4xl mb-3">ğŸ”¥</div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">1æ—¥ã®æ¶ˆè²»ã‚«ãƒ­ãƒªãƒ¼</h3>
                    <div id="tdeeResult" class="text-3xl font-bold text-orange-600">-</div>
                    <p class="text-gray-500 mt-2">kcal/æ—¥</p>
                </div>

                <!-- æ¨å¥¨æ‘‚å–ã‚«ãƒ­ãƒªãƒ¼ -->
                <div class="result-card rounded-2xl p-6 text-center">
                    <div class="text-4xl mb-3">ğŸ½ï¸</div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">æ¨å¥¨æ‘‚å–ã‚«ãƒ­ãƒªãƒ¼</h3>
                    <div id="recommendedCalories" class="text-3xl font-bold text-green-600">-</div>
                    <p class="text-gray-500 mt-2">kcal/æ—¥</p>
                </div>

                <!-- é€±é–“å¤‰åŒ– -->
                <div class="result-card rounded-2xl p-6 text-center">
                    <div class="text-4xl mb-3">ğŸ“Š</div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">é€±é–“ã®ä½“é‡å¤‰åŒ–äºˆæƒ³</h3>
                    <div id="weeklyChange" class="text-3xl font-bold text-blue-600">-</div>
                    <p class="text-gray-500 mt-2">kg/é€±</p>
                </div>

                <!-- ç›®æ¨™é”æˆæ—¥æ•° -->
                <div class="result-card rounded-2xl p-6 text-center">
                    <div class="text-4xl mb-3">ğŸ¯</div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">ç›®æ¨™é”æˆäºˆæƒ³</h3>
                    <div id="targetDays" class="text-3xl font-bold text-pink-600">-</div>
                    <p class="text-gray-500 mt-2">æ—¥å¾Œ</p>
                </div>

                <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒªãƒ³ã‚° -->
                <div class="result-card rounded-2xl p-6 text-center">
                    <div class="text-4xl mb-3">ğŸ’ª</div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">é€²æ—</h3>
                    <div class="relative inline-block">
                        <svg class="progress-ring w-24 h-24" viewBox="0 0 84 84">
                            <circle class="progress-ring-circle" stroke="#e5e7eb" stroke-width="6" fill="transparent" r="40" cx="42" cy="42"/>
                            <circle id="progressCircle" class="progress-ring-circle" stroke="#10b981" stroke-width="6" fill="transparent" r="40" cx="42" cy="42"/>
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span id="progressText" class="text-lg font-bold text-gray-700">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤º -->
            <div class="glass-card rounded-3xl p-8">
                <h3 class="text-2xl font-bold text-white mb-6 text-center">
                    <i class="fas fa-chart-line mr-2"></i>ã‚«ãƒ­ãƒªãƒ¼ãƒãƒ©ãƒ³ã‚¹å¯è¦–åŒ–
                </h3>
                <div class="bg-white rounded-2xl p-6">
                    <canvas id="calorieChart" width="400" height="200"></canvas>
                </div>
            </div>
        </div>

        <!-- ãƒ€ã‚¤ã‚¨ãƒƒãƒˆã‚µãƒãƒ¼ãƒˆ -->
        <div class="max-w-4xl mx-auto mb-12">
            <div class="glass-card rounded-3xl p-8 animate-fade-in">
                <div class="text-center mb-8">
                    <div class="text-4xl mb-4">ğŸƒâ€â™€ï¸</div>
                    <h2 class="text-3xl font-bold text-white mb-4">ãƒ€ã‚¤ã‚¨ãƒƒãƒˆæˆåŠŸã‚’ã‚µãƒãƒ¼ãƒˆ</h2>
                    <p class="text-gray-200 text-lg">ãŠã™ã™ã‚ãƒ€ã‚¤ã‚¨ãƒƒãƒˆãƒ—ãƒ­ãƒ†ã‚¤ãƒ³</p>
                </div>

                <div class="bg-white rounded-2xl p-6 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-800">ğŸ¥¤ ãŠã™ã™ã‚ãƒ€ã‚¤ã‚¨ãƒƒãƒˆãƒ—ãƒ­ãƒ†ã‚¤ãƒ³</h3>
                        <span class="bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold">äººæ°—No.1</span>
                    </div>
                    <p class="text-gray-600 mb-4">ã‚«ãƒ­ãƒªãƒ¼åˆ¶é™ä¸­ã§ã‚‚å¿…è¦ãªæ „é¤Šç´ ã‚’ã—ã£ã‹ã‚Šè£œçµ¦</p>
                    
                    <div class="bg-orange-50 rounded-xl p-4 mb-4">
                        <h4 class="font-bold text-orange-800 mb-2">ã“ã®ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³ã®ç‰¹å¾´</h4>
                        <ul class="space-y-1 text-orange-700">
                            <li>â€¢ ä½ã‚«ãƒ­ãƒªãƒ¼è¨­è¨ˆã§ãƒ€ã‚¤ã‚¨ãƒƒãƒˆä¸­ã«æœ€é©</li>
                            <li>â€¢ å¥³æ€§ã«å¬‰ã—ã„ã‚½ã‚¤ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³é…åˆ</li>
                            <li>â€¢ ç½®ãæ›ãˆãƒ€ã‚¤ã‚¨ãƒƒãƒˆã«åŠ¹æœçš„</li>
                            <li>â€¢ é€æ–™ç„¡æ–™ã§ãŠå¾—ã«ãŠè©¦ã—å¯èƒ½</li>
                        </ul>
                    </div>

                    <div class="text-center">
                        <a href="#" class="bg-red-500 hover:bg-red-600 text-white px-8 py-3 rounded-full font-bold inline-flex items-center transition-all duration-300 transform hover:scale-105">
                            <i class="fas fa-shopping-cart mr-2"></i>æ¥½å¤©ã§è³¼å…¥
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¨ˆç®—å±¥æ­´ -->
        <div class="max-w-4xl mx-auto">
            <div class="glass-card rounded-3xl p-8 animate-fade-in">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-white flex items-center">
                        <i class="fas fa-history mr-3 text-yellow-300"></i>è¨ˆç®—å±¥æ­´
                    </h2>
                    <button onclick="clearHistory()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full font-semibold transition-all duration-300">
                        <i class="fas fa-trash mr-2"></i>å±¥æ­´ã‚¯ãƒªã‚¢
                    </button>
                </div>
                <p class="text-gray-200 mb-4">è¨ˆç®—çµæœãŒã“ã“ã«ä¿å­˜ã•ã‚Œã¾ã™</p>
                <div id="history" class="space-y-3">
                    <!-- å±¥æ­´ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let chart = null;

        function calculateCalories() {
            const height = parseFloat(document.getElementById('height').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const age = parseFloat(document.getElementById('age').value);
            const gender = document.getElementById('gender').value;
            const activity = parseFloat(document.getElementById('activity').value);
            const targetWeight = parseFloat(document.getElementById('targetWeight').value);

            if (!height || !weight || !age || !gender || !activity || !targetWeight) {
                alert('ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            // BMRè¨ˆç®—ï¼ˆHarris-Benedictå¼ï¼‰
            let bmr;
            if (gender === 'male') {
                bmr = 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age);
            } else {
                bmr = 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
            }

            // TDEEè¨ˆç®—
            const tdee = bmr * activity;

            // ç›®æ¨™ä½“é‡ã¾ã§ã®å¤‰åŒ–é‡
            const weightDifference = weight - targetWeight;
            
            // æ¨å¥¨æ‘‚å–ã‚«ãƒ­ãƒªãƒ¼ï¼ˆ1é€±é–“ã§0.5kgæ¸›é‡ã‚’æƒ³å®šï¼‰
            const recommendedCalories = tdee - 500; // 1æ—¥500kcalæ¸›ã§é€±ç´„0.5kgæ¸›

            // é€±é–“ã®ä½“é‡å¤‰åŒ–äºˆæƒ³
            const weeklyChange = 0.5; // kg/é€±

            // ç›®æ¨™é”æˆäºˆæƒ³æ—¥æ•°
            const targetDays = Math.abs(weightDifference / weeklyChange * 7);

            // çµæœã‚’è¡¨ç¤º
            document.getElementById('bmrResult').textContent = Math.round(bmr);
            document.getElementById('tdeeResult').textContent = Math.round(tdee);
            document.getElementById('recommendedCalories').textContent = Math.round(recommendedCalories);
            document.getElementById('weeklyChange').textContent = weightDifference > 0 ? `-${weeklyChange}` : `+${weeklyChange}`;
            document.getElementById('targetDays').textContent = Math.round(targetDays);

            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤º
            updateProgress(weight, targetWeight);

            // çµæœã‚¨ãƒªã‚¢ã‚’è¡¨ç¤º
            const resultsDiv = document.getElementById('results');
            resultsDiv.classList.remove('hidden');
            resultsDiv.classList.add('animate-fade-in');

            // ãƒãƒ£ãƒ¼ãƒˆä½œæˆ
            createChart(bmr, tdee, recommendedCalories);

            // å±¥æ­´ã«ä¿å­˜
            saveToHistory({
                date: new Date().toLocaleString('ja-JP'),
                height, weight, targetWeight, bmr: Math.round(bmr), 
                tdee: Math.round(tdee), recommended: Math.round(recommendedCalories)
            });

            // çµæœã‚¨ãƒªã‚¢ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function updateProgress(current, target) {
            // é€²æ—ã‚’è¨ˆç®—ï¼ˆä»®ã«20%ã¨ã—ã¦è¨­å®šï¼‰
            const progress = 20;
            const circle = document.getElementById('progressCircle');
            const progressText = document.getElementById('progressText');
            
            const circumference = 2 * Math.PI * 40;
            const offset = circumference - (progress / 100) * circumference;
            
            circle.style.strokeDashoffset = offset;
            progressText.textContent = `${progress}%`;
        }

        function createChart(bmr, tdee, recommended) {
            const ctx = document.getElementById('calorieChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }
            
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['åŸºç¤ä»£è¬', 'æ´»å‹•ä»£è¬', 'æ¨å¥¨æ‘‚å–'],
                    datasets: [{
                        data: [bmr, tdee - bmr, recommended],
                        backgroundColor: [
                            '#8b5cf6',
                            '#f59e0b', 
                            '#10b981'
                        ],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });
        }

        function saveToHistory(data) {
            let history = JSON.parse(localStorage.getItem('calorieHistory')) || [];
            history.unshift(data);
            history = history.slice(0, 10); // æœ€æ–°10ä»¶ã¾ã§ä¿å­˜
            localStorage.setItem('calorieHistory', JSON.stringify(history));
            displayHistory();
        }

        function displayHistory() {
            const history = JSON.parse(localStorage.getItem('calorieHistory')) || [];
            const historyDiv = document.getElementById('history');
            
            if (history.length === 0) {
                historyDiv.innerHTML = '<p class="text-gray-300 italic">ã¾ã è¨ˆç®—å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                return;
            }
            
            historyDiv.innerHTML = history.map(item => `
                <div class="bg-white bg-opacity-20 rounded-xl p-4 text-white">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-semibold">${item.date}</span>
                        <span class="text-sm opacity-75">${item.height}cm / ${item.weight}kg â†’ ${item.targetWeight}kg</span>
                    </div>
                    <div class="grid grid-cols-3 gap-4 text-sm">
                        <div>BMR: ${item.bmr}kcal</div>
                        <div>TDEE: ${item.tdee}kcal</div>
                        <div>æ¨å¥¨: ${item.recommended}kcal</div>
                    </div>
                </div>
            `).join('');
        }

        function clearHistory() {
            if (confirm('è¨ˆç®—å±¥æ­´ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                localStorage.removeItem('calorieHistory');
                displayHistory();
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å±¥æ­´ã‚’è¡¨ç¤º
        document.addEventListener('DOMContentLoaded', function() {
            displayHistory();
        });
    </script>
</body>
</html>