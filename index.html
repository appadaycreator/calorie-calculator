<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçé „Ç´„É≠„É™„ÉºË®àÁÆóÊ©ü - ÁêÜÊÉ≥„ÅÆ‰ΩìÂûã„Å∏„ÅÆ„Çπ„Éû„Éº„Éà„Ç¨„Ç§„Éâ</title>
    <meta name="description" content="ÁßëÂ≠¶ÁöÑÊ†πÊã†„Å´Âü∫„Å•„ÅÑ„Åü„Ç´„É≠„É™„ÉºË®àÁÆó„ÅßÁêÜÊÉ≥„ÅÆ‰ΩìÂûã„ÇíÂÆüÁèæ„ÄÇÂü∫Á§é‰ª£Ë¨ù„ÉªÊ∂àË≤ª„Ç´„É≠„É™„Éº„ÉªÁõÆÊ®ôÈÅîÊàêÊó•Êï∞„ÇíÊ≠£Á¢∫„Å´ÁÆóÂá∫„Åó„Åæ„Åô„ÄÇ">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçé</text></svg>">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0"></script>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TXQGZRF9');</script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            padding: 40px 0;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .emoji-icon {
            font-size: 4rem;
            display: block;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* Calculator Card */
        .calculator-card {
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .calculator-title {
            font-size: 2rem;
            font-weight: 600;
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        /* Form Styling */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .form-input, .form-select {
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        .form-input::placeholder {
            color: #a0aec0;
        }

        /* Button */
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
            min-width: 200px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        /* Results Section */
        .results {
            display: none;
            margin-top: 40px;
        }

        .results.show {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .result-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-5px);
        }

        .result-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .result-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .result-unit {
            font-size: 1rem;
            color: #718096;
        }

        .result-description {
            font-size: 0.9rem;
            color: #a0aec0;
            margin-top: 10px;
        }

        /* Colors for different metrics */
        .bmr .result-value { color: #8b5cf6; }
        .tdee .result-value { color: #f59e0b; }
        .recommended .result-value { color: #10b981; }
        .weekly .result-value { color: #3b82f6; }
        .target .result-value { color: #ec4899; }

        /* Chart Section */
        .chart-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            text-align: center;
            margin-bottom: 25px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        /* Affiliate Section */
        .affiliate-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
        }

        .affiliate-title {
            font-size: 2rem;
            font-weight: 600;
            color: #333;
            text-align: center;
            margin-bottom: 25px;
        }

        .affiliate-subtitle {
            font-size: 1.1rem;
            color: #666;
            text-align: center;
            margin-bottom: 30px;
        }

        .product-highlight {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .product-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            font-weight: 500;
            color: #2d3748;
        }

        .feature-icon {
            color: #10b981;
            margin-right: 10px;
            font-size: 1.1rem;
        }

        /* History Section */
        .history-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            padding: 40px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .history-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: white;
        }

        .btn-secondary {
            background: #ef4444;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .history-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #ffd700;
        }

        .history-date {
            font-weight: 600;
            color: white;
            margin-bottom: 10px;
        }

        .history-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            color: #e2e8f0;
            font-size: 0.9rem;
        }

        /* Share Buttons */
        .share-section {
            text-align: center;
            margin: 30px 0;
        }

        .btn-share {
            background: #1da1f2;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-weight: 500;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .btn-share:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(29, 161, 242, 0.3);
        }

        .btn-download {
            background: #10b981;
        }

        .btn-download:hover {
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2.5rem;
            }

            .calculator-card {
                padding: 25px;
            }

            .form-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .results-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }

            .result-card {
                padding: 20px;
            }

            .result-value {
                font-size: 2rem;
            }

            .affiliate-section,
            .history-section {
                padding: 25px;
            }

            .history-header {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }

            .history-details {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: white;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus States */
        .form-input:focus,
        .form-select:focus,
        .btn-primary:focus,
        .btn-secondary:focus,
        .btn-share:focus {
            outline: 2px solid #4299e1;
            outline-offset: 2px;
        }

        /* Ê•ΩÂ§©„Ç¢„Éï„Ç£„É™„Ç®„Ç§„Éà„ÅÆ„É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
        .rakuten-affiliate {
            width: 100%;
            max-width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 20px 0;
            padding: 0;
        }

        .rakuten-affiliate iframe {
            max-width: 100%;
            height: auto;
            min-height: 300px;
        }

        /* „Éï„ÉÉ„Çø„Éº */
        .footer {
            background: rgba(255, 255, 255, 0.1);
            padding: 40px 20px;
            margin-top: 60px;
            color: white;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .copyright {
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .disclaimer {
            font-size: 0.8rem;
            opacity: 0.8;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .footer-links {
            margin-top: 20px;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
            margin: 0 10px;
            font-size: 0.9rem;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .footer-links a:hover {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }

            .calculator-card {
                padding: 20px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            .rakuten-affiliate {
                margin: 15px 0;
            }

            .footer {
                padding: 30px 15px;
            }
        }
    </style>
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXQGZRF9" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <span class="emoji-icon">üçé</span>
            <h1>„Ç´„É≠„É™„ÉºË®àÁÆóÊ©ü</h1>
            <p>ÁßëÂ≠¶ÁöÑÊ†πÊã†„Å´Âü∫„Å•„ÅÑ„ÅüHarris-BenedictÂºè„Åß„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂü∫Á§é‰ª£Ë¨ù„Å®ÁõÆÊ®ôÈÅîÊàê„Åæ„Åß„ÅÆÊúÄÈÅ©„Å™„Ç´„É≠„É™„Éº„Éó„É©„É≥„ÇíÁÆóÂá∫„Åó„Åæ„Åô</p>
        </header>

        <!-- Calculator -->
        <main class="calculator-card">
            <h2 class="calculator-title">Âü∫Êú¨ÊÉÖÂ†±„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</h2>
            
            <form id="calorieForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="height" class="form-label">üìè Ë∫´Èï∑ (cm)</label>
                        <input type="number" id="height" class="form-input" placeholder="170" min="100" max="250" step="0.1" required>
                        <small style="color: #718096; margin-top: 5px;">100„Äú250cm„ÅÆÁØÑÂõ≤„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</small>
                    </div>

                    <div class="form-group">
                        <label for="weight" class="form-label">‚öñÔ∏è ÁèæÂú®„ÅÆ‰ΩìÈáç (kg)</label>
                        <input type="number" id="weight" class="form-input" placeholder="70" min="20" max="300" step="0.1" required>
                        <small style="color: #718096; margin-top: 5px;">20„Äú300kg„ÅÆÁØÑÂõ≤„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</small>
                    </div>

                    <div class="form-group">
                        <label for="age" class="form-label">üéÇ Âπ¥ÈΩ¢</label>
                        <input type="number" id="age" class="form-input" placeholder="30" min="10" max="120" required>
                        <small style="color: #718096; margin-top: 5px;">10„Äú120Ê≠≥„ÅÆÁØÑÂõ≤„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</small>
                    </div>

                    <div class="form-group">
                        <label for="gender" class="form-label">üë§ ÊÄßÂà•</label>
                        <select id="gender" class="form-select" required>
                            <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                            <option value="male">üë® Áî∑ÊÄß</option>
                            <option value="female">üë© Â•≥ÊÄß</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="activity" class="form-label">üèÉ Ê¥ªÂãï„É¨„Éô„É´</label>
                        <select id="activity" class="form-select" required>
                            <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                            <option value="1.2">ü™ë Â∫ß„Çä„Åå„Å°Ôºà„Åª„Å®„Çì„Å©ÈÅãÂãï„Åó„Å™„ÅÑÔºâ</option>
                            <option value="1.375">üö∂ ËªΩ„ÅÑÈÅãÂãïÔºàÈÄ±1-3ÂõûÔºâ</option>
                            <option value="1.55">üèÉ ÊôÆÈÄö„ÅÆÈÅãÂãïÔºàÈÄ±3-5ÂõûÔºâ</option>
                            <option value="1.725">üí™ ÊøÄ„Åó„ÅÑÈÅãÂãïÔºàÈÄ±6-7ÂõûÔºâ</option>
                            <option value="1.9">üî• ÈùûÂ∏∏„Å´ÊøÄ„Åó„ÅÑÈÅãÂãïÔºà1Êó•2Âõû„Å™„Å©Ôºâ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="targetWeight" class="form-label">üéØ ÁõÆÊ®ô‰ΩìÈáç (kg)</label>
                        <input type="number" id="targetWeight" class="form-input" placeholder="65" min="20" max="300" step="0.1" required>
                        <small style="color: #718096; margin-top: 5px;">20„Äú300kg„ÅÆÁØÑÂõ≤„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</small>
                    </div>
                </div>

                <button type="submit" class="btn-primary">
                    üßÆ Ë®àÁÆó„Åô„Çã
                </button>
            </form>

            <!-- Loading -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>ÊúÄÈÅ©„Å™„Éó„É©„É≥„Çí‰ΩúÊàê‰∏≠...</p>
            </div>
        </main>

        <!-- Results -->
        <section id="results" class="results">
            <div class="calculator-card">
                <h2 class="calculator-title">üéØ „ÅÇ„Å™„Åü„ÅÆË®àÁÆóÁµêÊûú</h2>
                
                <div class="results-grid">
                    <div class="result-card bmr">
                        <span class="result-icon">‚ö°</span>
                        <div class="result-title">Âü∫Á§é‰ª£Ë¨ùÁéá</div>
                        <div class="result-value" id="bmrResult">-</div>
                        <div class="result-unit">kcal/Êó•</div>
                        <div class="result-description">ÁîüÂëΩÁ∂≠ÊåÅ„Å´ÂøÖË¶Å„Å™ÊúÄ‰Ωé„Ç´„É≠„É™„Éº</div>
                    </div>

                    <div class="result-card tdee">
                        <span class="result-icon">üî•</span>
                        <div class="result-title">1Êó•„ÅÆÊ∂àË≤ª„Ç´„É≠„É™„Éº</div>
                        <div class="result-value" id="tdeeResult">-</div>
                        <div class="result-unit">kcal/Êó•</div>
                        <div class="result-description">Ê¥ªÂãï„ÇíÂê´„ÇÄÁ∑èÊ∂àË≤ª„Ç´„É≠„É™„Éº</div>
                    </div>

                    <div class="result-card recommended">
                        <span class="result-icon">üçΩÔ∏è</span>
                        <div class="result-title">Êé®Â•®ÊëÇÂèñ„Ç´„É≠„É™„Éº</div>
                        <div class="result-value" id="recommendedResult">-</div>
                        <div class="result-unit">kcal/Êó•</div>
                        <div class="result-description">ÁõÆÊ®ôÈÅîÊàê„ÅÆ„Åü„ÇÅ„ÅÆÊëÇÂèñÈáè</div>
                    </div>

                    <div class="result-card weekly">
                        <span class="result-icon">üìä</span>
                        <div class="result-title">ÈÄ±Èñì„ÅÆ‰ΩìÈáçÂ§âÂåñ</div>
                        <div class="result-value" id="weeklyResult">-</div>
                        <div class="result-unit">kg/ÈÄ±</div>
                        <div class="result-description">ÂÅ•Â∫∑ÁöÑ„Å™„Éö„Éº„Çπ„Åß„ÅÆÂ§âÂåñ</div>
                    </div>

                    <div class="result-card target">
                        <span class="result-icon">üéØ</span>
                        <div class="result-title">ÁõÆÊ®ôÈÅîÊàê‰∫àÊÉ≥</div>
                        <div class="result-value" id="targetResult">-</div>
                        <div class="result-unit">Êó•Âæå</div>
                        <div class="result-description">Á∂ôÁ∂ö„Åô„Çå„Å∞ÈÅîÊàêÂèØËÉΩ</div>
                    </div>
                </div>

                <!-- Chart -->
                <div class="chart-section">
                    <h3 class="chart-title">üìä „Ç´„É≠„É™„Éº„Éê„É©„É≥„ÇπË©≥Á¥∞ÂàÜÊûê</h3>
                    <div class="chart-container">
                        <canvas id="calorieChart"></canvas>
                    </div>
                </div>

                <!-- Share Buttons -->
                <div class="share-section">
                    <button onclick="shareResults()" class="btn-share">
                        üì± ÁµêÊûú„Çí„Ç∑„Çß„Ç¢
                    </button>
                    <button onclick="downloadResults()" class="btn-share btn-download">
                        üìÑ ÁµêÊûú„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                    </button>
                </div>
            </div>
        </section>

        <!-- Affiliate Section -->
        <section class="affiliate-section">
            <h2 class="affiliate-title">üèÉ‚Äç‚ôÄÔ∏è „ÉÄ„Ç§„Ç®„ÉÉ„ÉàÊàêÂäü„Çí„Çµ„Éù„Éº„Éà</h2>
            <p class="affiliate-subtitle">„ÅÇ„Å™„Åü„ÅÆÁõÆÊ®ôÈÅîÊàê„Çí„Çµ„Éù„Éº„Éà„Åô„ÇãÂé≥ÈÅ∏ÂïÜÂìÅ</p>
            
            <div class="product-highlight">
                <h3 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 15px; color: #2d3748;">
                    ü•§ „Åä„Åô„Åô„ÇÅ„ÉÄ„Ç§„Ç®„ÉÉ„Éà„Éó„É≠„ÉÜ„Ç§„É≥
                </h3>
                
                <div class="product-features">
                    <div class="feature-item">
                        <span class="feature-icon">‚úÖ</span>
                        ‰Ωé„Ç´„É≠„É™„ÉºË®≠Ë®à„Åß„ÉÄ„Ç§„Ç®„ÉÉ„Éà‰∏≠„Å´ÊúÄÈÅ©
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">‚úÖ</span>
                        Â•≥ÊÄß„Å´Â¨â„Åó„ÅÑ„ÇΩ„Ç§„Éó„É≠„ÉÜ„Ç§„É≥ÈÖçÂêà
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">‚úÖ</span>
                        ÁΩÆ„ÅçÊèõ„Åà„ÉÄ„Ç§„Ç®„ÉÉ„Éà„Å´ÂäπÊûúÁöÑ
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">‚úÖ</span>
                        ÈÄÅÊñôÁÑ°Êñô„Åß„ÅäÂæó„Å´„ÅäË©¶„ÅóÂèØËÉΩ
                    </div>
                </div>
            </div>

            <div style="text-align: center; background: #f7fafc; padding: 20px; border-radius: 15px;">
                <table border="0" cellpadding="0" cellspacing="0" style="margin: 0 auto;"><tr><td><div style="border:1px solid #95a5a6;border-radius:.75rem;background-color:#FFFFFF;width:504px;margin:0px;padding:5px;text-align:center;overflow:hidden;"><table><tr><td style="width:240px"><a href="https://hb.afl.rakuten.co.jp/ichiba/48d485d8.5fb22ab4.48d485d9.de59eec5/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbambi-water%2Fbambidietshake%2F&link_type=picttext&ut=eyJwYWdlIjoiaXRlbSIsInR5cGUiOiJwaWN0dGV4dCIsInNpemUiOiIyNDB4MjQwIiwibmFtIjoxLCJuYW1wIjoicmlnaHQiLCJjb20iOjEsImNvbXAiOiJkb3duIiwicHJpY2UiOjEsImJvciI6MSwiY29sIjoxLCJiYnRuIjoxLCJwcm9kIjowLCJhbXAiOmZhbHNlfQ%3D%3D" target="_blank" rel="nofollow sponsored noopener" style="word-wrap:break-word;"><img src="https://hbb.afl.rakuten.co.jp/hgb/48d485d8.5fb22ab4.48d485d9.de59eec5/?me_id=1294199&item_id=10000052&pc=https%3A%2F%2Fthumbnail.image.rakuten.co.jp%2F%400_mall%2Fbambi-water%2Fcabinet%2Fpage%2Fbps%2Fbps_th00_2412.jpg%3F_ex%3D240x240&s=240x240&t=picttext" border="0" style="margin:2px" alt="„Éó„É≠„ÉÜ„Ç§„É≥„ÉÄ„Ç§„Ç®„ÉÉ„ÉàÂïÜÂìÅ" title="„Éó„É≠„ÉÜ„Ç§„É≥„ÉÄ„Ç§„Ç®„ÉÉ„ÉàÂïÜÂìÅ"></a></td><td style="vertical-align:top;width:248px;display: block;"><p style="font-size:12px;line-height:1.4em;text-align:left;margin:0px;padding:2px 6px;word-wrap:break-word"><a href="https://hb.afl.rakuten.co.jp/ichiba/48d485d8.5fb22ab4.48d485d9.de59eec5/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbambi-water%2Fbambidietshake%2F&link_type=picttext&ut=eyJwYWdlIjoiaXRlbSIsInR5cGUiOiJwaWN0dGV4dCIsInNpemUiOiIyNDB4MjQwIiwibmFtIjoxLCJuYW1wIjoicmlnaHQiLCJjb20iOjEsImNvbXAiOiJkb3duIiwicHJpY2UiOjEsImJvciI6MSwiY29sIjoxLCJiYnRuIjoxLCJwcm9kIjowLCJhbXAiOmZhbHNlfQ%3D%3D" target="_blank" rel="nofollow sponsored noopener" style="word-wrap:break-word;">Êú¨Êó•ÁµÇ‰∫ÜÔººP5ÂÄçÔºè„Éó„É≠„ÉÜ„Ç§„É≥ Â•≥ÊÄß „ÉÄ„Ç§„Ç®„ÉÉ„Éà „ÇΩ„Ç§„Éó„É≠„ÉÜ„Ç§„É≥ „Éó„É≠„ÉÜ„Ç§„É≥„ÉÄ„Ç§„Ç®„ÉÉ„Éà ÁΩÆ„ÅçÊèõ„Åà„ÉÄ„Ç§„Ç®„ÉÉ„Éà ÁΩÆ„ÅçÊèõ„Åà „Ç∑„Çß„Ç§„ÇØ „Éï„Ç°„Çπ„ÉÜ„Ç£„É≥„Ç∞ „Çø„É≥„Éë„ÇØË≥™ ‰ΩéÁ≥ñË≥™ ‰ΩéËÑÇË≥™ „Éõ„Ç®„Ç§„Éó„É≠„ÉÜ„Ç§„É≥ ‰Ωé„Ç´„É≠„É™„Éº „Éê„É≥„Éì„Ç¶„Ç©„Éº„Çø„Éº Êò•Â§è</a><br><span style="color: #e53e3e; font-weight: bold; font-size: 14px;">‰æ°Ê†ºÔºö2,998ÂÜÜÔºàÁ®éËæº„ÄÅÈÄÅÊñôÁÑ°Êñô)</span> <span style="color:#BBB">(2025/6/4ÊôÇÁÇπ)</span></p><div style="margin:10px;"><a href="https://hb.afl.rakuten.co.jp/ichiba/48d485d8.5fb22ab4.48d485d9.de59eec5/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbambi-water%2Fbambidietshake%2F&link_type=picttext&ut=eyJwYWdlIjoiaXRlbSIsInR5cGUiOiJwaWN0dGV4dCIsInNpemUiOiIyNDB4MjQwIiwibmFtIjoxLCJuYW1wIjoicmlnaHQiLCJjb20iOjEsImNvbXAiOiJkb3duIiwicHJpY2UiOjEsImJvciI6MSwiY29sIjoxLCJiYnRuIjoxLCJwcm9kIjowLCJhbXAiOmZhbHNlfQ%3D%3D" target="_blank" rel="nofollow sponsored noopener" style="word-wrap:break-word;"><img src="https://static.affiliate.rakuten.co.jp/makelink/rl.svg" style="float:left;max-height:27px;width:auto;margin-top:0" ></a><a href="https://hb.afl.rakuten.co.jp/ichiba/48d485d8.5fb22ab4.48d485d9.de59eec5/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbambi-water%2Fbambidietshake%2F%3Fscid%3Daf_pc_bbtn&link_type=picttext&ut=eyJwYWdlIjoiaXRlbSIsInR5cGUiOiJwaWN0dGV4dCIsInNpemUiOiIyNDB4MjQwIiwibmFtIjoxLCJuYW1wIjoicmlnaHQiLCJjb20iOjEsImNvbXAiOiJkb3duIiwicHJpY2UiOjEsImJvciI6MSwiY29sIjoxLCJiYnRuIjoxLCJwcm9kIjowLCJhbXAiOmZhbHNlfQ==" target="_blank" rel="nofollow sponsored noopener" style="word-wrap:break-word;"><div style="float:right;width:41%;height:27px;background-color:#bf0000;color:#fff!important;font-size:12px;font-weight:500;line-height:27px;margin-left:1px;padding: 0 12px;border-radius:16px;cursor:pointer;text-align:center;"> Ê•ΩÂ§©„ÅßË≥ºÂÖ• </div></a></div></td></tr></table></div><br><p style="color:#000000;font-size:12px;line-height:1.4em;margin:5px;word-wrap:break-word"></p></td></tr></table>
            </div>
        </section>

        <!-- History -->
        <section class="history-section">
            <div class="history-header">
                <h2 class="history-title">üìä Ë®àÁÆóÂ±•Ê≠¥</h2>
                <button onclick="clearHistory()" class="btn-secondary">
                    üóëÔ∏è Â±•Ê≠¥„Çí„ÇØ„É™„Ç¢
                </button>
            </div>
            <div id="historyContainer">
                <p style="color: #e2e8f0; text-align: center; font-style: italic;">
                    „Åæ„Å†Ë®àÁÆóÂ±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì
                </p>
            </div>
        </section>
    </div>

    <!-- „Éï„ÉÉ„Çø„Éº -->
    <footer class="footer">
        <div class="footer-content">
            <div class="copyright">
                ¬© 2024 „Ç´„É≠„É™„ÉºË®àÁÆóÊ©ü All Rights Reserved.
            </div>
            <div class="disclaimer">
                ÂÖçË≤¨‰∫ãÈ†ÖÔºö„Åì„ÅÆ„Çµ„Ç§„Éà„ÅßÊèê‰æõ„Åï„Çå„ÇãÊÉÖÂ†±„ÅØ„ÄÅ‰∏ÄËà¨ÁöÑ„Å™ÂÅ•Â∫∑ÁÆ°ÁêÜ„ÅÆÂèÇËÄÉÊÉÖÂ†±„Å®„Åó„Å¶Êèê‰æõ„Åï„Çå„Çã„ÇÇ„ÅÆ„Åß„Åô„ÄÇ
                ÂåªÁôÇÁöÑ„Å™„Ç¢„Éâ„Éê„Ç§„Çπ„ÇÑË®∫Êñ≠„ÇíÁõÆÁöÑ„Å®„Åó„Åü„ÇÇ„ÅÆ„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÂÅ•Â∫∑„Å´Èñ¢„Åô„ÇãÂÖ∑‰ΩìÁöÑ„Å™ÂïèÈ°å„ÇÑÊá∏Âøµ„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„ÄÅ
                ÂøÖ„ÅöÂåªÂ∏´„ÇÑÂ∞ÇÈñÄÂÆ∂„Å´„ÅîÁõ∏Ë´á„Åè„Å†„Åï„ÅÑ„ÄÇ„Åæ„Åü„ÄÅ„Åì„ÅÆ„Çµ„Ç§„Éà„ÅÆÂà©Áî®„Å´„Çà„Å£„Å¶Áîü„Åò„Åü„ÅÑ„Åã„Å™„ÇãÊêçÂÆ≥„Å´„Å§„ÅÑ„Å¶„ÇÇ„ÄÅ
                ÂΩì„Çµ„Ç§„Éà„ÅØË≤¨‰ªª„ÇíË≤†„ÅÑ„Åæ„Åõ„Çì„ÄÇ
            </div>
            <div class="footer-links">
                <a href="privacy-policy.html">„Éó„É©„Ç§„Éê„Ç∑„Éº„Éù„É™„Ç∑„Éº</a>
                <a href="terms.html">Âà©Áî®Ë¶èÁ¥Ñ</a>
                <a href="contact.html">„ÅäÂïè„ÅÑÂêà„Çè„Åõ</a>
            </div>
        </div>
    </footer>

    <script>
        // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
        let chart = null;
        let currentResults = null;

        // localStorage „ÅÆÂÆâÂÖ®„Å™Êìç‰Ωú
        const SafeStorage = {
            get: (key) => {
                try {
                    return localStorage.getItem(key);
                } catch (e) {
                    console.warn('localStorage read failed:', e);
                    return null;
                }
            },
            set: (key, value) => {
                try {
                    localStorage.setItem(key, value);
                    return true;
                } catch (e) {
                    console.warn('localStorage write failed:', e);
                    return false;
                }
            },
            remove: (key) => {
                try {
                    localStorage.removeItem(key);
                    return true;
                } catch (e) {
                    console.warn('localStorage remove failed:', e);
                    return false;
                }
            }
        };

        // „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£Èñ¢Êï∞
        function formatNumber(num) {
            return Math.round(num).toLocaleString();
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = 'toast show';
            toast.style.backgroundColor = type === 'success' ? '#10b981' : '#ef4444';
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Ë®àÁÆóÈñ¢Êï∞
        function calculateBMR(weight, height, age, gender) {
            if (gender === 'male') {
                return 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age);
            } else {
                return 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
            }
        }

        function calculateTDEE(bmr, activityLevel) {
            return bmr * parseFloat(activityLevel);
        }

        function calculateCalorieAdjustment(currentWeight, targetWeight, tdee) {
            const weightDifference = currentWeight - targetWeight;
            const caloriesPerKg = 7700;
            
            if (Math.abs(weightDifference) < 0.1) {
                return {
                    recommendedCalories: Math.round(tdee),
                    weeklyChange: 0,
                    estimatedDays: 0
                };
            }
            
            if (weightDifference > 0) {
                // Ê∏õÈáè
                const safeWeeklyLoss = Math.min(0.7, weightDifference / 10);
                const dailyDeficit = (safeWeeklyLoss * caloriesPerKg) / 7;
                
                return {
                    recommendedCalories: Math.round(tdee - dailyDeficit),
                    weeklyChange: -safeWeeklyLoss,
                    estimatedDays: Math.round((weightDifference / safeWeeklyLoss) * 7)
                };
            } else {
                // Â¢óÈáè
                const safeWeeklyGain = Math.min(0.5, Math.abs(weightDifference) / 10);
                const dailySurplus = (safeWeeklyGain * caloriesPerKg) / 7;
                
                return {
                    recommendedCalories: Math.round(tdee + dailySurplus),
                    weeklyChange: safeWeeklyGain,
                    estimatedDays: Math.round((Math.abs(weightDifference) / safeWeeklyGain) * 7)
                };
            }
        }

        // „É°„Ç§„É≥Ë®àÁÆóÂá¶ÁêÜ
        function calculateCalories() {
            const height = parseFloat(document.getElementById('height').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const age = parseInt(document.getElementById('age').value);
            const gender = document.getElementById('gender').value;
            const activity = document.getElementById('activity').value;
            const targetWeight = parseFloat(document.getElementById('targetWeight').value);

            // „Éê„É™„Éá„Éº„Ç∑„Éß„É≥
            if (!height || !weight || !age || !gender || !activity || !targetWeight) {
                showToast('„Åô„Åπ„Å¶„ÅÆÈ†ÖÁõÆ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }

            if (height < 100 || height > 250 || weight < 20 || weight > 300 || 
                age < 10 || age > 120 || targetWeight < 20 || targetWeight > 300) {
                showToast('ÂÖ•ÂäõÂÄ§„ÅåÁØÑÂõ≤Â§ñ„Åß„Åô', 'error');
                return;
            }

            // „É≠„Éº„Éá„Ç£„É≥„Ç∞Ë°®Á§∫
            document.getElementById('loading').classList.add('show');
            
            // Ë®àÁÆóÂÆüË°åÔºàÈÅÖÂª∂„ÇíËøΩÂä†„Åó„Å¶„É≠„Éº„Éá„Ç£„É≥„Ç∞ÂäπÊûú„ÇíÊºîÂá∫Ôºâ
            setTimeout(() => {
                try {
                    const bmr = calculateBMR(weight, height, age, gender);
                    const tdee = calculateTDEE(bmr, activity);
                    const adjustment = calculateCalorieAdjustment(weight, targetWeight, tdee);

                    currentResults = {
                        height, weight, targetWeight, bmr, tdee, ...adjustment
                    };

                    displayResults(currentResults);
                    saveToHistory(currentResults);
                    
                    document.getElementById('loading').classList.remove('show');
                    document.getElementById('results').classList.add('show');
                    
                    // ÁµêÊûú„Çª„ÇØ„Ç∑„Éß„É≥„Åæ„Åß„Çπ„ÇØ„É≠„Éº„É´
                    document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
                    
                    showToast('Ë®àÁÆó„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ');
                } catch (error) {
                    document.getElementById('loading').classList.remove('show');
                    showToast('Ë®àÁÆó‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü', 'error');
                    console.error('Calculation error:', error);
                }
            }, 1500);
        }

        // ÁµêÊûúË°®Á§∫
        function displayResults(data) {
            document.getElementById('bmrResult').textContent = formatNumber(data.bmr);
            document.getElementById('tdeeResult').textContent = formatNumber(data.tdee);
            document.getElementById('recommendedResult').textContent = formatNumber(data.recommendedCalories);
            document.getElementById('weeklyResult').textContent = `${data.weeklyChange > 0 ? '+' : ''}${data.weeklyChange.toFixed(1)}`;
            document.getElementById('targetResult').textContent = data.estimatedDays === 0 ? 'ÈÅîÊàêÊ∏à„Åø' : formatNumber(data.estimatedDays);

            createChart(data);
        }

        // „ÉÅ„É£„Éº„Éà‰ΩúÊàê
        function createChart(data) {
            const ctx = document.getElementById('calorieChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }
            
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Âü∫Á§é‰ª£Ë¨ù', 'Ê¥ªÂãï‰ª£Ë¨ù', 'Êé®Â•®ÊëÇÂèñ'],
                    datasets: [{
                        data: [data.bmr, data.tdee - data.bmr, data.recommendedCalories],
                        backgroundColor: ['#8b5cf6', '#f59e0b', '#10b981'],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: { size: 14, weight: '500' }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: (context) => {
                                    return `${context.label}: ${formatNumber(context.parsed)} kcal`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Â±•Ê≠¥ÁÆ°ÁêÜ
        function saveToHistory(data) {
            const historyData = SafeStorage.get('calorieHistory');
            let history = historyData ? JSON.parse(historyData) : [];
            
            const historyItem = {
                date: new Date().toLocaleString('ja-JP'),
                ...data
            };
            
            history.unshift(historyItem);
            history = history.slice(0, 10); // ÊúÄÊñ∞10‰ª∂„Åæ„Åß‰øùÂ≠ò
            
            SafeStorage.set('calorieHistory', JSON.stringify(history));
            displayHistory();
        }

        function displayHistory() {
            const historyData = SafeStorage.get('calorieHistory');
            const history = historyData ? JSON.parse(historyData) : [];
            const container = document.getElementById('historyContainer');
            
            if (history.length === 0) {
                container.innerHTML = '<p style="color: #e2e8f0; text-align: center; font-style: italic;">„Åæ„Å†Ë®àÁÆóÂ±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>';
                return;
            }
            
            container.innerHTML = history.map(item => `
                <div class="history-item">
                    <div class="history-date">${item.date}</div>
                    <div class="history-details">
                        <div>Ë∫´Èï∑: ${item.height}cm</div>
                        <div>‰ΩìÈáç: ${item.weight}kg</div>
                        <div>ÁõÆÊ®ô: ${item.targetWeight}kg</div>
                        <div>BMR: ${formatNumber(item.bmr)}kcal</div>
                        <div>TDEE: ${formatNumber(item.tdee)}kcal</div>
                        <div>Êé®Â•®: ${formatNumber(item.recommendedCalories)}kcal</div>
                        <div>‰∫àÊÉ≥: ${item.estimatedDays === 0 ? 'ÈÅîÊàêÊ∏à„Åø' : item.estimatedDays + 'Êó•'}</div>
                    </div>
                </div>
            `).join('');
        }

        function clearHistory() {
            if (confirm('„Åô„Åπ„Å¶„ÅÆË®àÁÆóÂ±•Ê≠¥„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                SafeStorage.remove('calorieHistory');
                displayHistory();
                showToast('Â±•Ê≠¥„Çí„ÇØ„É™„Ç¢„Åó„Åæ„Åó„Åü');
            }
        }

        // „Ç∑„Çß„Ç¢„Éª„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊ©üËÉΩ
        function shareResults() {
            if (!currentResults) {
                showToast('„Åæ„ÅöË®àÁÆó„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }
            
            const shareText = `üçé „Ç´„É≠„É™„ÉºË®àÁÆóÁµêÊûú\n\n` +
                             `Âü∫Á§é‰ª£Ë¨ù: ${formatNumber(currentResults.bmr)} kcal\n` +
                             `Ê∂àË≤ª„Ç´„É≠„É™„Éº: ${formatNumber(currentResults.tdee)} kcal\n` +
                             `Êé®Â•®ÊëÇÂèñ: ${formatNumber(currentResults.recommendedCalories)} kcal\n` +
                             `ÁõÆÊ®ôÈÅîÊàê„Åæ„Åß: ${currentResults.estimatedDays}Êó•\n\n` +
                             `#„Ç´„É≠„É™„ÉºË®àÁÆó #„ÉÄ„Ç§„Ç®„ÉÉ„Éà #ÂÅ•Â∫∑ÁÆ°ÁêÜ #Á∂ôÁ∂ö„ÅØÂäõ„Å™„Çä\n` +
                             `${window.location.href}`;

            if (navigator.share) {
                navigator.share({
                    title: '„Ç´„É≠„É™„ÉºË®àÁÆóÁµêÊûú',
                    text: shareText
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    showToast('ÁµêÊûú„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ');
                }).catch(() => {
                    showToast('„Ç≥„Éî„Éº„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'error');
                });
            }
        }

        function downloadResults() {
            if (!currentResults) {
                showToast('„Åæ„ÅöË®àÁÆó„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }
            
            const report = `„Ç´„É≠„É™„ÉºË®àÁÆóÁµêÊûú„É¨„Éù„Éº„Éà\n` +
                          `ÁîüÊàêÊó•ÊôÇ: ${new Date().toLocaleString('ja-JP')}\n\n` +
                          `Âü∫Êú¨ÊÉÖÂ†±:\n` +
                          `Ë∫´Èï∑: ${currentResults.height}cm\n` +
                          `‰ΩìÈáç: ${currentResults.weight}kg\n` +
                          `ÁõÆÊ®ô‰ΩìÈáç: ${currentResults.targetWeight}kg\n\n` +
                          `Ë®àÁÆóÁµêÊûú:\n` +
                          `Âü∫Á§é‰ª£Ë¨ùÁéá: ${formatNumber(currentResults.bmr)} kcal/Êó•\n` +
                          `1Êó•„ÅÆÊ∂àË≤ª„Ç´„É≠„É™„Éº: ${formatNumber(currentResults.tdee)} kcal/Êó•\n` +
                          `Êé®Â•®ÊëÇÂèñ„Ç´„É≠„É™„Éº: ${formatNumber(currentResults.recommendedCalories)} kcal/Êó•\n` +
                          `ÈÄ±Èñì„ÅÆ‰ΩìÈáçÂ§âÂåñ‰∫àÊÉ≥: ${currentResults.weeklyChange.toFixed(1)} kg/ÈÄ±\n` +
                          `ÁõÆÊ®ôÈÅîÊàê‰∫àÊÉ≥Êó•Êï∞: ${currentResults.estimatedDays}Êó•\n`;

            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `„Ç´„É≠„É™„ÉºË®àÁÆóÁµêÊûú_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('„É¨„Éù„Éº„Éà„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„ÅüÔºÅ');
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.addEventListener('DOMContentLoaded', function() {
            // „Éï„Ç©„Éº„É†ÈÄÅ‰ø°
            document.getElementById('calorieForm').addEventListener('submit', function(e) {
                e.preventDefault();
                calculateCalories();
            });

            // Â±•Ê≠¥Ë°®Á§∫
            displayHistory();

            // „Ç¢„ÇØ„Çª„Ç∑„Éì„É™„ÉÜ„Ç£: Enter„Ç≠„Éº„Åß„ÅÆÈÄÅ‰ø°
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && e.target.tagName !== 'BUTTON') {
                    e.preventDefault();
                    calculateCalories();
                }
            });
        });
    </script>
</body>
</html>